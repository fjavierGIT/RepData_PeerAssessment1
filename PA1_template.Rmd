---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

```{r Loads knitr library}
library(knitr)
```


## Loading and preprocessing the data

```{r Load Data}
myDataf <- read.csv(unz("./activity.zip", "activity.csv"), header = TRUE,
                    colClasses = c("integer", "Date", "numeric"), sep = ",",
                    na.strings = "NA", quote = "\"")
```

## What is mean total number of steps taken per day?

Histogram of the total number of steps taken each day

```{r Histogram steps x day}
myDataf.steps <- aggregate(steps ~ date, myDataf, sum)
kable(head(myDataf.steps))
with(myDataf.steps, plot(myDataf.steps$date,myDataf.steps$steps, type="h",
                    xlab = "Date", ylab ="Steps",
                    col="red"))
```

Mean and median number of steps taken each day
```{r Mean + Median steps x day}
mean(myDataf.steps$steps, na.rm = TRUE)
median(myDataf.steps$steps, na.rm = TRUE)
```

## What is the average daily activity pattern?

Time series plot of the average number of steps taken
```{r  Plot Avg steps}
steps.average <- aggregate(steps ~ interval, myDataf, mean)
with(steps.average, 
                    plot(steps.average$interval,steps.average$steps, type = "l",
                    xlab = "Interval", ylab = "Average Steps", col = "red"))
```

The 5-minute interval that, on average, contains the maximum number of steps
```{r Max Avg steps Interval}
steps.average[which.max(steps.average$steps),]
```


## Imputing missing values

### Code to describe and show a strategy for imputing missing data  
1. Calculate total number of missing values in the dataset 
```{r Number of NAs}
NAs <- is.na(myDataf$steps)
sum(NAs)
```

2. Strategy for filling in all of the missing values in the dataset:  
We will fill in all missing NAs with the average number of steps in the same 5-min interval

3. New Dataset with missing data filled

```{r New Dataset}
myDataf.filled <- myDataf                   #new data frame
myDataf.filled$id <- 1:nrow(myDataf.filled) #creates id column. will help order later
newNA <- merge(myDataf.filled[NAs,], steps.average, by="interval", sort = F) #add means 2 NAs
newNA <-  newNA[order(newNA$id), ]          #re-order
myDataf.filled$steps[NAs] <- newNA$steps.y  #filled data frame
myDataf.filled$id <- NULL                   #drops id column
kable(head(myDataf.filled))                 #shows new data
```

4. Histogram of the total number of steps taken each day after missing values are imputed
```{r Histogram missing imputed}


```

## Are there differences in activity patterns between weekdays and weekends?
